<%= calendar(:number_of_days => 500) do |date| %>
  <% if @friend_transition_dates.include? date %>
    <%= date.strftime "%B %-d" %><br>
    <% if @transition_dates.include? date %>
      <% @transitions.select { |transition| transition.first == date }.each do |transition| %>
        <%= "#{transition.last.name} in #{transition[1]}" %> for you<br>
      <% end %>
    <% end %>
    <% @friend_transition = @friend_transitions.select { |transition| transition.first == date }.each do |transition| %>
    <%= "#{transition[2].name} in #{transition[1]} for #{transition[3].name}" %><br>
    <% end %>
  <% elsif @transition_dates.include? date %>
    <%= date.strftime "%B %-d" %><br>
    <% @transition = @transitions.select { |transition| transition.first == date }.first %>
    <%= "#{@transition.last.name} in #{@transition[1]}" %> for you
  <% elsif date.day == 1 %>
    <%= date.strftime "%B %-d" %>
  <% else %>
    <%= date.strftime "%-d" %>
  <% end %>
<% end %>
